---
title: 'JPA 이슈'
published: 2026-02-06
description: 'JPA'
pinned: false
author: 'necteo'
image: ''
tags: ['JPA', 'Oracle', 'Spring Boot']
category: 'ORM'
draft: false
---

### Oracle에서 JPA Id 자동 증가

Oracle DB를 사용중이라 AUTO INCREMENT가 없는데
JPA Entity의 Id를 자동 증가 하고 싶어서 알아보았다.

#### 해결

```java
@GeneratedValue(
	strategy = GenerationType.SEQUENCE,
	generator = "br_seq_gen"
)

@SequenceGenerator(
	name = "br_seq_gen",
	sequenceName = "BR3_NO_SEQ",
	allocationSize = 1
)
private long no;
```

이렇게 두 가지 어노테이션을 사용하면 가능하다고 한다.

여기서 @GeneratedValue의 generator와 @SequenceGenerator의 name이 같아야 한다

그리고 sequenceName은 Oracle에서의 실제 Sequence 이름을 주면 된다

### DEFAULT 설정을 했는데 null이 들어간다?

시퀀스 설정을 끝내고 insert를 했는데

regdate값에 null이 들어가있었다

그런데 똑같은 DEFAULT 설정이 된 hit는 0으로 초기화 되어있는 것

#### 원인

regdate는 String이고

hit는 int로 설정했는데

여기서 달라졌다

자바 자체에서

String은 null이 기본값이고

int는 0이 기본값인 것

그래서 hit가 0이 된건 DEFAULT 설정때문이 아니라 자바때문이었다

#### 해결

그래서 @DynamicInsert를 주고 (null은 insert되지 않는다)

```java
@Column(insertable = false, updatable = false)
private Date regdate;

@Column(insertable = false)
@ColumnDefault("0")
private int hit;
```

이렇게 insertable에 false를 줬다

hit는 지금도 가능하지만 형식상 ColumnDefault를 줬다

### 마무리

전부 적용하면 이런 느낌

```java
@Entity
@Table(name = "board")
@Data
@DynamicInsert
@DynamicUpdate
@SequenceGenerator(
	name = "br_seq_gen",
	sequenceName = "BR3_NO_SEQ",
	allocationSize = 1
)
public class Board {

	@Id
	@GeneratedValue(strategy = GenerationType.SEQUENCE, generator = "br_seq_gen")
	private long no;

	@Column(insertable = false, updatable = false)
	private Date regdate;

	@Column(insertable = false)
	@ColumnDefault("0")
	private int hit;

}
```

JPA는 자바에서 해결해야 되다보니 까다로운게 좀 많은 것 같다

그래도 익숙해지면 그만큼 편할 듯
