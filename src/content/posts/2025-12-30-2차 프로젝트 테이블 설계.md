---
title: '설계 하면서 들었던 생각들'
published: 2025-12-30
description: '2차 프로젝트 설계 구상 과정'
author: 'necteo'
tags: ['Oracle', 'SQL']
category: 'SQL'
draft: false
---

매점 테이블명을 정하는 과정

- 영화관 매점 영어로 검색
- concession stand라는 단어 등장
- store와 고민하다가 concession으로 결정
- 뭔가 애매해서 다시 알아보니 concession은 사업권을 의미하는 것 같고
  concession stand가 사업권을 받은 매점을 의미하는 듯
- 이제 store와 concession stand 중 고민
- 근데 이름이 너무 길지 않나
- ChatGPT와 Gemini를 싸우게 한 결과 store로 결정
- gpt는 이름이 가진 의미에 집중해서 concession을 추천했지만
  작은 프로젝트기도 하고 우리나라 영화관에서 store라고 하면 팝콘/콜라가 먼저 떠오른다고 생각했음

주문 상태를 나타내는 컬럼은 NUMBER? VARCHAR2?

- state를 0, 1, 2 이렇게 할 지
  'PAID', 'READY', 'DONE', 'CANCELED' 이렇게 할 지 고민
- 숫자는 다루기도 쉽고 용량도 적고 속도에서 이득을 볼 수 있다
- 문자는 알아보기 쉽다, 별도의 코드 설명 테이블 불필요
- 상태가 4개정도 뿐이고 상품 주문은 내가 주로 만들 예정이라 VARCHAR2로 결정

내가 설계한 거

```sql
CREATE TABLE store (
    store_id    NUMBER,
    store_name  VARCHAR2(100) NOT NULL,
    location    VARCHAR2(100) NOT NULL,
    staff_id    NUMBER,
    CONSTRAINT store_id_pk PRIMARY KEY(store_id),
    CONSTRAINT store_sid_fk FOREIGN KEY(staff_id) REFERENCES member(id)
);

-- 식품명 예) 더블콤보/팝콘/셀프탄산 등
CREATE TABLE store_product (
    product_id  NUMBER,
    name        VARCHAR2(500) NOT NULL,
    isSet       CHAR(1), -- y/n
    CONSTRAINT sp_id_pk PRIMARY KEY(product_id)
);

-- 세트 구성 예)팝콘M2+탄산M2
CREATE TABLE store_product_set (
    product_set_id      NUMBER,
    product_id          NUMBER, -- 더블콤보 등
    product_item_id     NUMBER, -- 팝콘(M)/셀프탄산(L)
    quantity            NUMBER,  -- 1개/2개
    discount            NUMBER  -- 항목 별 할인금액
);

-- 단품 예) 팝콘(M)/셀프탄산(L)/에이드
CREATE TABLE store_product_item (
    product_item_id         NUMBER,
    product_id              NUMBER, -- 팝콘/셀프탄산 등
    option_category         VARCHAR2(100) NOT NULL, -- 팝콘/탄산/스낵
    item_name               VARCHAR2(100) NOT NULL,  -- 팝콘/셀프탄산/에이드
    item_size               VARCHAR2(10),   -- L/M
    base_price              NUMBER DEFAULT 0,  -- 5500
    CONSTRAINT spi_piid_pk PRIMARY KEY(product_item_id),
    CONSTRAINT spi_pid_fk FOREIGN KEY(product_id) REFERENCES store_product(product_id),
    CONSTRAINT spi_size_ck CHECK(item_size IN ('L', 'M'))
);

-- 식품 상세 정보
CREATE TABLE store_product_detail (
    product_detail_id   NUMBER,
    detail_name         VARCHAR2(100) NOT NULL,  -- 달콤팝콘
    detail_size         VARCHAR2(10),   -- M
    detail_price        NUMBER,  -- 6500
    product_type        NUMBER  -- 0:팝콘/1:탄산...
);

CREATE TABLE store_order (
    order_id    NUMBER,
    member_id   NUMBER,
    store_id    NUMBER,
    regdate     DATE DEFAULT SYSDATE,
    total_price NUMBER, -- 총금액
    state       VARCHAR2(20)    -- 상품 접수/거절/준비중/준비완료/취소/픽업완료
);

-- 주문한 식품명
CREATE TABLE store_order_item (
    order_item_id   NUMBER,
    order_id        NUMBER,
    product_id      NUMBER,
    quantity        NUMBER,
    item_price      NUMBER
);

-- 주문한 식품 상세 정보
CREATE TABLE store_order_option (
    order_option_id     NUMBER,
    order_item_id       NUMBER,
    product_item_id     NUMBER,
    product_detail_id   NUMBER
);

-- 식품 재고
CREATE TABLE store_product_stock (
    stock_id    NUMBER,
    store_id    NUMBER,
    product_detail_id   NUMBER,
    stock               NUMBER DEFAULT 0,   -- 재고
    regdate             DATE DEFAULT SYSDATE,   -- 생성일
    moddate             DATE    -- 수정일
);
```

우선 order_item 테이블은 필요하다고 판단

메뉴
콤보/단품
팝콘/콜라
달콤팝콘/기본팝콘
콜라/환타
사이즈는 M/L
개수

재고/등록일/추가일?

주문
번호/누가/언제/총금액?
무엇을/몇개

설계하다보니 뭔가 너무 복잡해서 다시 만들어야겠다고 판단

위에서부터 내려와서 그런가 관계가 꼬이는 느낌이다

이번엔 식품의 상세 정보부터 해봐야겠다
