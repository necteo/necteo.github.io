---
title: 'AWSì— ì˜¬ë¦° ì„œë²„ì— HTTPS ì ìš©í•˜ê¸°'
published: 2026-01-30
description: "AWS, nginx, DuckDNS, Cerbot, Let's Encrypt"
pinned: false
author: 'necteo'
image: ''
tags: ['AWS', 'nginx', 'Ubuntu', 'DuckDNS']
category: 'CI/CD'
draft: false
---

í”„ë¡œì íŠ¸ë¥¼ ë§ˆë¬´ë¦¬í•˜ê³  ë°°í¬ë¥¼ í–ˆëŠ”ë°

ì‚¬ìš©ì ìœ„ì¹˜ë¥¼ ê°€ì ¸ì˜¤ëŠ” Geolocation APIê°€ ê±°ë¶€ë˜ëŠ” ìƒí™©ì´ ë°œìƒí–ˆë‹¤

í° ì¼ì´ ë‚¬ìŒì„ ì§ê°í•œ ë‚˜ëŠ” ê³§ë°”ë¡œ ê²€ìƒ‰ì„ ì‹œì‘í–ˆëŠ”ë°

Geolocationê°™ì€ APIëŠ” httpsì—ì„œë§Œ ì‘ë™í•œë‹¤ê³  í•œë‹¤ ã„±-

ê·¸ë¦¬í•˜ì—¬ í—ˆê²ì§€ê² AWS ì„œë²„ë¥¼ 1ì‹œê°„ì•ˆì— httpsê°€ ê°€ëŠ¥í•˜ê²Œ ë§Œë“¤ì–´ì•¼ í–ˆëŠ”ë°...

### 1ë‹¨ê³„: ìì²´ ì„œëª… ì¸ì¦ì„œ ìƒì„± (ì„ì‹œ)

```bash
# 1. ë””ë ‰í† ë¦¬ ìƒì„±
sudo mkdir -p /etc/ssl/private

# 2. ìì²´ ì„œëª… ì¸ì¦ì„œ ìƒì„±
sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 \
  -keyout /etc/ssl/private/selfsigned.key \
  -out /etc/ssl/certs/selfsigned.crt \
  -subj "/C=KR/ST=Seoul/L=Seoul/O=MyCompany/OU=IT/CN=ì„ì‹œì¸ì¦ì„œ/emailAddress=admin@example.com"

# 3. ê¶Œí•œ ì„¤ì •
sudo chmod 600 /etc/ssl/private/selfsigned.key
sudo chmod 644 /etc/ssl/certs/selfsigned.crt
```

### 2ë‹¨ê³„: Nginx ê¸°ë³¸ ì„¤ì •

```bash
# 1. ê¸°ì¡´ ì„¤ì • ë°±ì—…
sudo cp /etc/nginx/sites-available/default /etc/nginx/sites-available/default.backup

# 2. ì„¤ì • íŒŒì¼ í¸ì§‘
sudo nano /etc/nginx/sites-available/default
```

**ì „ì²´ ë‚´ìš©ì„ ì•„ë˜ë¡œ êµì²´:**

```nginx
# HTTP â†’ HTTPS ë¦¬ë‹¤ì´ë ‰íŠ¸
server {
  listen 80;
  listen [::]:80;
  server_name _;  # ì„ì‹œë¡œ ëª¨ë“  ë„ë©”ì¸ í—ˆìš©
  return 301 https://$host$request_uri;
}

# HTTPS ì„¤ì •
server {
  listen 443 ssl;
  listen [::]:443 ssl;
  server_name _;

  # ì„ì‹œ ìì²´ ì„œëª… ì¸ì¦ì„œ (ë‚˜ì¤‘ì— Certbotì´ ìë™ ìˆ˜ì •)
  ssl_certificate /etc/ssl/certs/selfsigned.crt;
  ssl_certificate_key /etc/ssl/private/selfsigned.key;

  # SSL í”„ë¡œí† ì½œ ì„¤ì •
  ssl_protocols TLSv1.2 TLSv1.3;
  ssl_ciphers HIGH:!aNULL:!MD5;
  ssl_prefer_server_ciphers on;

  # Spring Boot í”„ë¡ì‹œ ì„¤ì •
  location / {
    proxy_pass http://localhost:8000;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;
    proxy_set_header X-Forwarded-Host $host;
    proxy_set_header X-Forwarded-Port $server_port;
  }

  # WebSocket ì§€ì› (ì£¼ë¬¸ ì‹¤ì‹œê°„ ì•Œë¦¼)
  location /ws {
    proxy_pass http://localhost:8000/ws;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection "upgrade";
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;
  }

  # ë¡œê·¸ íŒŒì¼
  access_log /var/log/nginx/access.log;
  error_log /var/log/nginx/error.log;
}
```

```bash
# 3. ë¬¸ë²• ê²€ì‚¬
sudo nginx -t

# ì˜ˆìƒ ì¶œë ¥:
# nginx: the configuration file /etc/nginx/nginx.conf syntax is ok
# nginx: configuration file /etc/nginx/nginx.conf test is successful

# 4. Nginx ì¬ì‹œì‘
sudo systemctl restart nginx

# 5. ìƒíƒœ í™•ì¸
sudo systemctl status nginx
```

### 3ë‹¨ê³„: DuckDNS ë„ë©”ì¸ ìƒì„±

**ì›¹ ë¸Œë¼ìš°ì €ì—ì„œ:**

1. https://www.duckdns.org ì ‘ì†
2. GitHub, Google ë“±ìœ¼ë¡œ ë¡œê·¸ì¸
3. ë„ë©”ì¸ ì´ë¦„ ì…ë ¥ (ì˜ˆ: sist-all-movie)

- ê²°ê³¼: sist-all-movie.duckdns.org

4. current ipì— ì„œë²„ IP ì…ë ¥ (ì˜ˆ: 54.147.137.211)
5. "update ip" ë²„íŠ¼ í´ë¦­

**DNS ì „íŒŒ í™•ì¸ (1~2ë¶„ ì†Œìš”)**

```bash
# DNS ì „íŒŒ í™•ì¸
nslookup sist-all-movie.duckdns.org

# ì˜ˆìƒ ì¶œë ¥:
# Server: 8.8.8.8
# Address: 8.8.8.8#53
#
# Non-authoritative answer:
# Name: sist-all-movie.duckdns.org
# Address: 54.147.137.211

# DNSê°€ ì „íŒŒë  ë•Œê¹Œì§€ 1~5ë¶„ ëŒ€ê¸°
```

### 4ë‹¨ê³„: Nginx ì„¤ì •ì„ ë„ë©”ì¸ìœ¼ë¡œ ë³€ê²½

```bash
sudo nano /etc/nginx/sites-available/default
```

**server_name ë¶€ë¶„ë§Œ ìˆ˜ì •:**

```nginx
# HTTP â†’ HTTPS ë¦¬ë‹¤ì´ë ‰íŠ¸
server {
  listen 80;
  listen [::]:80;
  server_name sist-all-movie.duckdns.org;  # â† ì—¬ê¸° ìˆ˜ì •!
  return 301 https://$host$request_uri;
}

# HTTPS ì„¤ì •
server {
  listen 443 ssl;
  listen [::]:443 ssl;
  server_name sist-all-movie.duckdns.org;  # â† ì—¬ê¸° ìˆ˜ì •!

  # ë‚˜ë¨¸ì§€ëŠ” ë™ì¼...
}
```

```bash
# ë¬¸ë²• ê²€ì‚¬
sudo nginx -t

# ì¬ì‹œì‘
sudo systemctl restart nginx
```

### 5ë‹¨ê³„: AWS ë³´ì•ˆ ê·¸ë£¹ ì„¤ì • í™•ì¸

**AWS Console â†’ EC2 â†’ Security Groups â†’ Inbound Rules:**

```
Type: HTTP
Protocol: TCP
Port: 80
Source: 0.0.0.0/0

Type: HTTPS
Protocol: TCP
Port: 443
Source: 0.0.0.0/0

Type: Custom TCP
Protocol: TCP
Port: 8000
Source: 127.0.0.1/32 (localhostë§Œ í—ˆìš©)
```

### 6ë‹¨ê³„: Certbot ì„¤ì¹˜

```bash
# íŒ¨í‚¤ì§€ ì—…ë°ì´íŠ¸
sudo apt update

# Certbot ë° Nginx í”ŒëŸ¬ê·¸ì¸ ì„¤ì¹˜
sudo apt install certbot python3-certbot-nginx -y

# ì„¤ì¹˜ í™•ì¸
certbot --version
```

### 7ë‹¨ê³„: Let's Encrypt ì¸ì¦ì„œ ë°œê¸‰

```bash
# Certbotìœ¼ë¡œ SSL ì¸ì¦ì„œ ìë™ ë°œê¸‰ ë° ì„¤ì •
sudo certbot --nginx -d sist-all-movie.duckdns.org
```

**í”„ë¡¬í”„íŠ¸ ì‘ë‹µ:**

```
Enter email address (used for urgent renewal and security notices):
â†’ your@email.com ì…ë ¥ í›„ Enter

Please read the Terms of Service at https://letsencrypt.org/documents/LE-SA-v1.4-April-3-2024.pdf
(A)gree/(C)ancel:
â†’ A ì…ë ¥ í›„ Enter

Would you be willing to share your email address with the Electronic Frontier Foundation?
(Y)es/(N)o:
â†’ N ì…ë ¥ í›„ Enter
```

**ì„±ê³µ ë©”ì‹œì§€:**

```
Successfully received certificate.
Certificate is saved at: /etc/letsencrypt/live/sist-all-movie.duckdns.org/fullchain.pem
Key is saved at:         /etc/letsencrypt/live/sist-all-movie.duckdns.org/privkey.pem
This certificate expires on 2026-05-01.
These files will be updated when the certificate renews.
Certbot has set up a scheduled task to automatically renew this certificate in the background.

Deploying certificate
Successfully deployed certificate for sist-all-movie.duckdns.org to /etc/nginx/sites-enabled/default
Congratulations! You have successfully enabled HTTPS on https://sist-all-movie.duckdns.org
```

### 8ë‹¨ê³„: ì¸ì¦ì„œ ì ìš© í™•ì¸

```bash
# 1. ì¸ì¦ì„œ í™•ì¸
sudo certbot certificates

# ì˜ˆìƒ ì¶œë ¥:
# Found the following certs:
#   Certificate Name: sist-all-movie.duckdns.org
#     Serial Number: xxx
#     Key Type: RSA
#     Domains: sist-all-movie.duckdns.org
#     Expiry Date: 2026-05-01 12:34:56+00:00 (VALID: 89 days)
#     Certificate Path: /etc/letsencrypt/live/sist-all-movie.duckdns.org/fullchain.pem
#     Private Key Path: /etc/letsencrypt/live/sist-all-movie.duckdns.org/privkey.pem

# 2. Nginx ì„¤ì • í™•ì¸ (Certbotì´ ìë™ ìˆ˜ì •í•¨)
sudo cat /etc/nginx/sites-available/default | grep ssl_certificate

# ì˜ˆìƒ ì¶œë ¥:
# ssl_certificate /etc/letsencrypt/live/sist-all-movie.duckdns.org/fullchain.pem; # managed by Certbot
# ssl_certificate_key /etc/letsencrypt/live/sist-all-movie.duckdns.org/privkey.pem; # managed by Certbot

# 3. HTTPS í…ŒìŠ¤íŠ¸
curl -I https://sist-all-movie.duckdns.org

# ì˜ˆìƒ ì¶œë ¥:
# HTTP/1.1 200
# Server: nginx/1.24.0 (Ubuntu)
# ...
```

### 9ë‹¨ê³„: ë¸Œë¼ìš°ì € ì ‘ì† í…ŒìŠ¤íŠ¸

#### ë¸Œë¼ìš°ì €ì—ì„œ:

```
https://sist-all-movie.duckdns.org
```

**í™•ì¸ ì‚¬í•­:**

- âœ… ìë¬¼ì‡  ì•„ì´ì½˜ (ğŸ”’)
- âœ… "ì—°ê²°ì´ ì•ˆì „í•¨" í‘œì‹œ
- âœ… ê²½ê³  ì—†ìŒ!

**Geolocation API í…ŒìŠ¤íŠ¸ (F12 â†’ Console):**

```javascript
navigator.geolocation.getCurrentPosition(
	(pos) => {
		console.log('âœ… ìœ„ì¹˜ ì ‘ê·¼ ì„±ê³µ!');
		console.log('ìœ„ë„:', pos.coords.latitude);
		console.log('ê²½ë„:', pos.coords.longitude);
	},
	(err) => {
		console.error('âŒ ì‹¤íŒ¨:', err.message);
	},
);
```

**ìœ„ì¹˜ ê¶Œí•œ íŒì—…:**

```
sist-all-movie.duckdns.orgì´(ê°€) ì‚¬ìš©ìì˜ ìœ„ì¹˜ë¥¼ í™•ì¸í•˜ë ¤ê³  í•©ë‹ˆë‹¤
[ì°¨ë‹¨]  [í—ˆìš©] â† í—ˆìš© í´ë¦­!
```

### 10ë‹¨ê³„: ìë™ ê°±ì‹  ì„¤ì • í™•ì¸

```bash
# ìë™ ê°±ì‹  í…ŒìŠ¤íŠ¸ (ì‹¤ì œë¡œ ê°±ì‹ í•˜ì§€ëŠ” ì•ŠìŒ)
sudo certbot renew --dry-run

# ì„±ê³µ ë©”ì‹œì§€:
# Congratulations, all simulated renewals succeeded

# ìë™ ê°±ì‹  íƒ€ì´ë¨¸ í™•ì¸
sudo systemctl status certbot.timer

# ì˜ˆìƒ ì¶œë ¥:
# â— certbot.timer - Run certbot twice daily
#      Loaded: loaded (/lib/systemd/system/certbot.timer; enabled; vendor preset: enabled)
#      Active: active (waiting) since...
```

**ìë™ ê°±ì‹  ë¡œì§:**

- ì¸ì¦ì„œëŠ” 90ì¼ í›„ ë§Œë£Œ
- Certbotì´ ìë™ìœ¼ë¡œ 60ì¼ ì „ì— ê°±ì‹ 
- ë³„ë„ ì‘ì—… ë¶ˆí•„ìš”

### 11ë‹¨ê³„: ì„±ëŠ¥ ìµœì í™” (ì„ íƒ ì‚¬í•­)

**HTTP/2 í™œì„±í™”**

```bash
sudo nano /etc/nginx/sites-available/default
```

```nginx
server {
    listen 443 ssl http2;  # â† http2 ì¶”ê°€
    listen [::]:443 ssl http2;  # â† http2 ì¶”ê°€
    server_name sist-all-movie.duckdns.org;

    # ... ë‚˜ë¨¸ì§€ ë™ì¼
}
```

```bash
sudo nginx -t
sudo systemctl reload nginx

# HTTP/2 í™•ì¸
curl -I --http2 https://sist-all-movie.duckdns.org
# HTTP/2 200 â† ì´ë ‡ê²Œ ë‚˜ì˜¤ë©´ ì„±ê³µ
```

**Gzip ì••ì¶• í™œì„±í™”**

```bash
sudo nano /etc/nginx/nginx.conf
```

**http ë¸”ë¡ ì•ˆì— ì¶”ê°€:**

```nginx
http {
    # ... ê¸°ì¡´ ì„¤ì •

    # Gzip ì••ì¶•
    gzip on;
    gzip_vary on;
    gzip_proxied any;
    gzip_comp_level 6;
    gzip_types text/plain text/css text/xml text/javascript
               application/json application/javascript
               application/xml+rss application/rss+xml
               font/truetype font/opentype
               application/vnd.ms-fontobject image/svg+xml;
    gzip_disable "msie6";
}
```

```bash
sudo nginx -t
sudo systemctl reload nginx
```

**ìµœì¢… ì²´í¬ë¦¬ìŠ¤íŠ¸**

- [x] Nginx ì„¤ì¹˜ ë° ê¸°ë³¸ ì„¤ì •
- [x] ìì²´ ì„œëª… ì¸ì¦ì„œ ìƒì„± (ì„ì‹œ)
- [x] DuckDNS ë„ë©”ì¸ ìƒì„±
- [x] DNS ì „íŒŒ í™•ì¸
- [x] Nginx server_name ë„ë©”ì¸ìœ¼ë¡œ ë³€ê²½
- [x] AWS ë³´ì•ˆ ê·¸ë£¹ 80, 443 í¬íŠ¸ í—ˆìš©
- [x] Certbot ì„¤ì¹˜
- [x] Let's Encrypt ì¸ì¦ì„œ ë°œê¸‰
- [x] HTTPS ì ‘ì† í™•ì¸
- [x] ë¸Œë¼ìš°ì € ê²½ê³  ì—†ìŒ í™•ì¸
- [x] Geolocation API ì‘ë™ í™•ì¸
- [x] ìë™ ê°±ì‹  ì„¤ì • í™•ì¸
- [ ] HTTP/2 í™œì„±í™” (ì„ íƒ)
- [ ] Gzip ì••ì¶• í™œì„±í™” (ì„ íƒ)

### íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

**Certbot ì‹¤íŒ¨: "Connection refused"**

```bash
# 80ë²ˆ í¬íŠ¸ í™•ì¸
sudo lsof -i :80

# Nginxê°€ ì‹¤í–‰ ì¤‘ì¸ì§€ í™•ì¸
sudo systemctl status nginx

# AWS ë³´ì•ˆ ê·¸ë£¹ì—ì„œ 80ë²ˆ í¬íŠ¸ ì—´ë ¤ ìˆëŠ”ì§€ í™•ì¸
```

**DNS ì „íŒŒ ì•ˆë¨**

```bash
# DNS ìºì‹œ ì‚­ì œ
sudo systemd-resolve --flush-caches

# ë‹¤ì‹œ í™•ì¸
nslookup sist-all-movie.duckdns.org

# 1~5ë¶„ ëŒ€ê¸° í›„ ì¬ì‹œë„
```

**ë¸Œë¼ìš°ì €ì—ì„œ ì—¬ì „íˆ ê²½ê³  í‘œì‹œ**

```bash
# ë¸Œë¼ìš°ì € ìºì‹œ ì‚­ì œ
# Chrome: Ctrl + Shift + Delete

# ì‹œí¬ë¦¿ ëª¨ë“œë¡œ ì¬ì ‘ì†

# ì¸ì¦ì„œ í™•ì¸
sudo certbot certificates
```

**certbotì—ì„œ ì¸ì¦ì„œë¥¼ ë°›ì•„ì•¼ https ì ‘ì†ì„ í•´ë„ ë¹„ê³µê°œê°€ ì•„ë‹ˆë¼ëŠ” ê²½ê³ ê°€ ì‚¬ë¼ì§„ë‹¤**

## ì™„ë£Œ! ğŸ‰

**ì ‘ì† ì£¼ì†Œ:**

```
https://sist-all-movie.duckdns.org
```

### ê²°ë¡ 

í•œì°¸ì„ í—¤ë§¤ë©´ì„œ ê²¨ìš°ê²¨ìš° ì ìš©í•˜ê³  ë§ˆë¬´ë¦¬ë¡œ ì²˜ìŒë¶€í„° ì •ë¦¬í–ˆë‹¤

awsì—ì„œëŠ” 443 portë¥¼ ì—´ì–´ì£¼ê³ 

ufwë¡œ ë°©í™”ë²½ì„ ì‘ë™ì‹œì¼°ë‹¤ê°€ Jenkinsê°€ ì‹¤íŒ¨í•´ì„œ disableí–ˆë”ë‹ˆ ë˜ë”ë¼..

awsëŠ” ufw í•¨ë¶€ë¡œ í‚¤ì§€ ë§ì•„ì•¼ê² ë‹¤

ì•„ë¬´íŠ¼ ai ì—†ì—ˆìœ¼ë©´ ë” ì˜¤ë˜ ê±¸ë ¤ì„œ í”„ë¡œì íŠ¸ ë°œí‘œ ë§í–ˆì„ì§€ë„..

ê³ ë§™ë‹¤ í´ë¡œë“œì•¼
